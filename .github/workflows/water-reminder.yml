name: Water Reminder

on:
  workflow_dispatch:
  schedule:
    - cron: "0 */2 * * *"   # every 2 hours
  repository_dispatch:
    types: [goal_completed]

jobs:
  send:
    runs-on: ubuntu-latest
    steps:
      - name: Send Telegram message
        env:
          BOT_TOKEN: ${{ secrets.BOT_TOKEN }}
          CHAT_ID: ${{ secrets.CHAT_ID }}
        run: |
          if [ "${{ github.event_name }}" = "repository_dispatch" ]; then
            MESSAGE="ðŸŽ‰ You completed todayâ€™s water goal! Great job ðŸ’§"
          else
            MESSAGE="ðŸ’§ Time to drink water!"
          fi

          echo "Sending: $MESSAGE"

          curl --fail --silent --show-error \
          "https://api.telegram.org/bot${BOT_TOKEN}/sendMessage" \
          -d chat_id="${CHAT_ID}" \
          -d text="$MESSAGE"
